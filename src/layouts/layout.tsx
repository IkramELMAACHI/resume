import Head from "next/head";
import React from "react";
import Link from "next/link";
import { useRouter } from "next/router";
import { signOut, useSession } from "next-auth/react";
import { Avatar, AvatarImage } from "@/components/ui/avatar";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";

interface LayoutI {
  children: React.ReactNode;
}

export default function Layout({ children }: LayoutI) {
  return (
    <>
      <Head>
        <title>Resumint</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Navbar />
      <main className="flex min-h-screen flex-col p-5">{children}</main>
      <Footer />
    </>
  );
}

function Navbar() {
  const { data } = useSession();
  const { push } = useRouter();
  return (
    <nav className="flex flex-1 justify-between border border-gray-200 bg-white px-3 py-2">
      <Link href="/" className="flex items-center">
        {/* <img
            src="https://flowbite.com/docs/images/logo.svg"
            className="mr-3 h-8"
            alt="Flowbite Logo"
          /> */}
        <span className="self-center whitespace-nowrap text-2xl text-green-600">
          Resumint
        </span>
      </Link>

      {data?.user ? (
        <DropdownMenu>
          <DropdownMenuTrigger>
            <div className="flex items-center space-x-2">
              <p className="text-sm">{data.user.name}</p>
              <Avatar>
                <AvatarImage
                  sizes="sm"
                  src={data.user.image ?? "/"}
                  alt="@shadcn"
                />
              </Avatar>
            </div>
          </DropdownMenuTrigger>
          <DropdownMenuContent>
            <DropdownMenuLabel>My Account</DropdownMenuLabel>
            <DropdownMenuSeparator />
            <DropdownMenuItem>Profile</DropdownMenuItem>
            <DropdownMenuItem
              onClick={() => {
                void push("/resumes");
              }}
            >
              My resumes
            </DropdownMenuItem>
            <DropdownMenuItem
              onClick={() => {
                void signOut();
              }}
              className="!hover:bg-red-50 !hover:text-red-600 text-red-500"
            >
              Logout
            </DropdownMenuItem>
          </DropdownMenuContent>
        </DropdownMenu>
      ) : (
        <Link href="/login">Login</Link>
      )}
    </nav>
  );
}

function Footer() {
  return <div className="flex flex-1 border p-2">Footer</div>;
}
